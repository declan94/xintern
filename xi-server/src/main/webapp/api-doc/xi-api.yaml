swagger: '2.0'
info:
  description: |
    
  version: 1.0.0
  title: 享实习API
  contact:
    email: chenye94@qq.com
host: localhost:8080
basePath: /api
schemes:
 - http
consumes:
  - application/json
produces:
  - application/json
tags:
- name: student
  description: 学生相关
- name: company
  description: 企业相关
- name: position
  description: 职位相关
- name: resume
  description: 简历（实习关系）相关
- name: news
  description: 资讯相关
- name: pointlog
  description: 积分记录
- name: notification
  description: 通知消息
- name: account
  description: 账号相关
- name: other
  description: 其他
- name: admin
  description: 管理员相关

paths:
  /students:
    post:
      tags:
      - student
      summary: 学生注册
      parameters:
      - in: body
        name: student
        description: 注册学生的信息
        required: true
        schema:
          $ref: '#/definitions/Student'
      responses:
        200:
          description: 注册成功
          schema:
            $ref: '#/definitions/Student'
        403:
          description: 注册失败，手机号已被注册
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments
    get:
      tags:
      - admin
      summary: 获取学生列表
      parameters:
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回学生列表。
          schema:
            $ref: '#/definitions/List-Student'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error' 

  /students/login:
    post:
      tags:
      - student
      summary: 学生登录
      parameters:
      - in: body
        name: account
        description: 登录信息
        required: true
        schema:
          $ref: '#/definitions/BasicAccount'
      responses:
        200:
          description: 登录成功，返回学生信息
          schema:
            $ref: '#/definitions/Student'
        403:
          description: 登录失败，账号不存在或密码错误
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments

  /students/login/wechat:
    post:
      tags:
      - student
      summary: 学生微信登录
      parameters:
      - in: query
        name: openid
        description: 微信授权openid
        required: true
        type: string
      responses:
        200:
          description: 登录成功，返回学生信息
          schema:
            $ref: '#/definitions/Student'
        403:
          description: 登录失败，账号不存在
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments

  /students/{studentId}:
    get:
      tags:
      - student
      - admin
      summary: 获取学生信息
      parameters:
      - in: path
        name: studentId
        description: 学生Id，若当前登录为学生的账号，只能获取自己的信息，可以设置为0。
        required: true
        type: integer
      responses:
        200:
          description: 成功，返回对应学生信息
          schema:
            $ref: '#/definitions/Student'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        403:
          description: 获取失败，权限不允许
        404:
          description: 获取失败，此学生不存在
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
      - student
      - admin
      summary: 修改学生信息
      parameters:
      - in: path
        name: studentId
        description: 学生Id，若当前登录为学生的账号，只能获取自己的信息，可以设置为0。
        required: true
        type: integer
      - in: body
        name: student
        description: 修改内容
        required: true
        schema:
            $ref: '#/definitions/StudentUpdater' 
      responses:
        200:
          description: 修改成功，返回对应学生信息
          schema:
            $ref: '#/definitions/Student'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        403:
          description: 修改失败，权限不允许
        404:
          description: 修改失败，此学生不存在
          schema:
            $ref: '#/definitions/Error'

  /students/{studentId}/resumes:
    get:
      tags:
      - student
      - resume
      - admin
      summary: 获取学生投出的简历信息
      parameters:
      - in: path
        name: studentId
        description: 学生Id，设置为0则代表当前登录学生
        required: true
        type: integer
      - in: query
        name: state
        description: 筛选简历状态，可以提供多个值。 （例如：?state=ENDED&state=CANCELD 可同时获取两种状态）
        type: string
        enum:
          - NEW
          - WAIT_STU_CONFIRM
          - WAIT_COMP_CONFIRM
          - CONFIRMED
          - OFFERED
          - WORKING
          - ENDED
          - CANCELED
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回简历列表信息
          schema:
            $ref: '#/definitions/List-Resume'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        403:
          description: 获取失败，权限不允许
        404:
          description: 获取失败，此学生不存在
          schema:
            $ref: '#/definitions/Error'

  /companies:
    post:
      tags:
      - company
      summary: 企业注册
      parameters:
      - in: body
        name: company
        description: 注册企业的信息
        required: true
        schema:
          $ref: '#/definitions/Company'
      responses:
        200:
          description: 注册成功
          schema:
            $ref: '#/definitions/Company'
        403:
          description: 注册失败，手机号已被注册
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments
    get:
      tags:
      - company
      - admin
      summary: 筛选企业列表
      parameters:
      - in: query
        name: verified
        type: boolean
        description: 是否认证
      - in: query
        name: industry
        type: string
        description: 行业
      - in: query
        name: type
        type: string
        description: 公司性质
      - in: query
        name: scale
        type: string
        description: 公司大小
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回公司列表信息
          schema:
            $ref: '#/definitions/List-Company'
        500:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  
  /companies/login:
    post:
      tags:
      - company
      summary: 企业登录
      parameters:
      - in: body
        name: account
        description: 登录信息
        required: true
        schema:
          $ref: '#/definitions/BasicAccount'
      responses:
        200:
          description: 登录成功，返回企业信息
          schema:
            $ref: '#/definitions/Company'
        400:
          description: Bad request, invalid arguments
        403:
          description: 登录失败，账号不存在或密码错误
          schema:
            $ref: '#/definitions/Error'

  /companies/{companyId}:
    get:
      tags:
      - company
      - admin
      summary: 获取企业信息
      parameters:
      - in: path
        name: companyId
        description: 企业Id，若当前登录为企业的账号，设置为0表示获取自己的信息。
        required: true
        type: integer
      responses:
        200:
          description: 成功，返回对应企业信息
          schema:
            $ref: '#/definitions/Company'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        403:
          description: 获取失败，权限不允许
        404:
          description: 获取失败，此企业不存在
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
      - company
      - admin
      summary: 修改企业信息
      parameters:
      - in: path
        name: companyId
        description: 企业Id，若当前登录为企业的账号，只能获取自己的信息，可以设置为0。
        required: true
        type: integer
      - in: body
        name: company
        description: 修改内容
        required: true
        schema:
            $ref: '#/definitions/CompanyUpdater' 
      responses:
        200:
          description: 修改成功，返回对应企业信息
          schema:
            $ref: '#/definitions/Company'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        403:
          description: 修改失败，权限不允许
        404:
          description: 修改失败，此企业不存在
          schema:
            $ref: '#/definitions/Error'

  /companies/{companyId}/positions:
    get:
      tags:
      - company
      - position
      - admin
      summary: 获取企业的职位信息
      parameters:
      - in: path
        name: companyId
        description: 企业Id，若当前登录为企业的账号，设置为0代表当前账号的企业。
        required: true
        type: integer
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回职位列表信息
          schema:
            $ref: '#/definitions/List-Position'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        403:
          description: 获取失败，权限不允许
        404:
          description: 获取失败，此企业不存在
          schema:
            $ref: '#/definitions/Error'

  /companies/{companyId}/resumes:
    get:
      tags:
      - company
      - resume
      - admin
      summary: 获取企业收到的简历信息
      parameters:
      - in: path
        name: companyId
        description: 企业Id，设置为0则代表当前登录企业
        required: true
        type: integer
      - in: query
        name: state
        description: 筛选简历状态，可以提供多个值。 （例如：?state=ENDED&state=CANCELD 可同时获取两种状态）
        type: string
        enum:
          - NEW
          - WAIT_STU_CONFIRM
          - WAIT_COMP_CONFIRM
          - CONFIRMED
          - OFFERED
          - WORKING
          - ENDED
          - CANCELED
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回简历列表信息
          schema:
            $ref: '#/definitions/List-Resume'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        403:
          description: 获取失败，权限不允许
        404:
          description: 获取失败，此公司不存在
          schema:
            $ref: '#/definitions/Error'

  /companies/{companyId}/rates:
    get:
      tags:
      - company
      - rate
      - admin
      summary: 获取企业收到的学生评价信息
      parameters:
      - in: path
        name: companyId
        description: 企业Id，设置为0则代表当前登录企业
        required: true
        type: integer
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回评价信息列表
          schema:
            $ref: '#/definitions/List-Rate'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        403:
          description: 获取失败，权限不允许
        404:
          description: 获取失败，此公司不存在
          schema:
            $ref: '#/definitions/Error'

  /positions:
    post:
      tags:
      - position
      summary: 新增职位信息
      parameters:
      - in: body
        name: position
        description: 职位信息
        required: true
        schema:
          $ref: '#/definitions/Position'
      responses:
        200:
          description: 新增成功
          schema:
            $ref: '#/definitions/Position'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments
    get:
      tags:
      - position
      - admin
      summary: 筛选职位列表
      parameters:
      - in: query
        name: keyword
        type: string
        description: 搜索关键词（职位公司名称）
      - in: query
        name: verified
        type: boolean
        description: 是否认证
      - in: query
        name: industry
        type: string
        description: 行业
      - in: query
        name: area
        type: string
        description: 地点
      - in: query
        name: type
        type: string
        description: 公司性质
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回职位列表信息
          schema:
            $ref: '#/definitions/List-Position'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error'
  
  /positions/subscription:
    get:
      tags:
      - position
      summary: 获取订阅的职位列表。
      description: 必须由学生发起。若当前账号订阅信息为空，等价于get /positions。
      parameters:
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回职位列表信息
          schema:
            $ref: '#/definitions/List-Position'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error'

  /positions/{positionId}:
    get:
      tags:
      - position
      - admin
      summary: 获取职位信息
      parameters:
      - in: path
        name: positionId
        description: 职位Id。
        required: true
        type: integer
      responses:
        200:
          description: 成功，返回对应职位信息
          schema:
            $ref: '#/definitions/Position'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        404:
          description: 获取失败，此职位不存在
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
      - position
      - admin
      summary: 修改职位信息
      description: 企业账号只能修改属于自己的职位信息。
      parameters:
      - in: path
        name: positionId
        description: 职位Id
        required: true
        type: integer
      - in: body
        name: position
        description: 职位信息的修改
        required: true
        schema:
          $ref: '#/definitions/PositionUpdater'
      responses:
        200:
          description: 修改成功，返回修改后的职位信息
          schema:
            $ref: '#/definitions/Position'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments

  /positions/{positionId}/resumes:
    get:
      tags:
      - position
      - resume
      - admin
      summary: 获取职位的简历信息
      parameters:
      - in: path
        name: positionId
        description: 职位Id
        required: true
        type: integer
      - in: query
        name: state
        description: 筛选简历状态，可以提供多个值。 （例如：?state=ENDED&state=CANCELD 可同时获取两种状态）
        type: string
        enum:
          - NEW
          - WAIT_STU_CONFIRM
          - WAIT_COMP_CONFIRM
          - CONFIRMED
          - OFFERED
          - WORKING
          - ENDED
          - CANCELED
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回简历列表信息
          schema:
            $ref: '#/definitions/List-Resume'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        403:
          description: 获取失败，权限不允许
        404:
          description: 获取失败，此职位不存在
          schema:
            $ref: '#/definitions/Error'

  /positions/{positionId}/collect:
    post:
      tags:
      - position
      summary: 收藏职位（必须以学生身份登录）
      parameters:
      - in: path
        name: positionId
        description: 职位Id
        required: true
        type: integer
      responses:
        200:
          description: 收藏成功，返回职位信息
          schema:
            $ref: '#/definitions/Position'
        401:
          description: 当前未登录
        403:
          description: 已经收藏
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
      - position
      summary: 取消收藏职位（必须以学生身份登录）
      parameters:
      - in: path
        name: positionId
        description: 职位Id
        required: true
        type: integer
      responses:
        200:
          description: 取消收藏成功，返回职位信息
          schema:
            $ref: '#/definitions/Position'
        401:
          description: 当前未登录
        403:
          description: 当前未收藏
          schema:
            $ref: '#/definitions/Error'

  /positions/collect:
    get:
      tags:
      - position
      summary: 获取收藏的职位（必须以学生身份登录）
      parameters:
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回职位列表信息
          schema:
            $ref: '#/definitions/List-Position'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error'

  /resumes:
    post:
      tags:
      - resume
      summary: 学生投递简历
      description: 须登陆学生账号，简历的stuId会自动设置为当前学生的id
      parameters:
      - in: body
        name: resume
        description: 简历信息
        required: true
        schema:
          $ref: '#/definitions/Resume'
      responses:
        200:
          description: 投递成功
          schema:
            $ref: '#/definitions/Resume'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments

  /resumes/{resumeId}:
    get:
      tags:
      - resume
      - admin
      summary: 获取简历信息
      parameters:
      - in: path
        name: resumeId
        description: 简历Id。
        required: true
        type: integer
      responses:
        200:
          description: 成功，返回对应简历信息
          schema:
            $ref: '#/definitions/Resume'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
        404:
          description: 获取失败，此简历不存在
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
      - resume
      - admin
      summary: 修改简历信息
      description: |
        企业账号只能修改属于自己职位下的简历，学生也只能修改自己投出的简历。
        对于状态的修改须遵守状态转移图.
      parameters:
      - in: path
        name: resumeId
        description: 简历Id
        required: true
        type: integer
      - in: body
        name: resume
        description: 简历信息的修改
        required: true
        schema:
          $ref: '#/definitions/ResumeUpdater'
      responses:
        200:
          description: 修改成功，返回修改后的简历信息
          schema:
            $ref: '#/definitions/Resume'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments
  
  /resumes/{resumeId}/rate:
    post:
      tags:
      - resume
      summary: 实习互评
      parameters:
      - in: path
        name: resumeId
        description: 简历Id
        required: true
        type: integer
      - in: body
        name: rate
        description: 评价实体
        required: true
        schema:
          $ref: '#/definitions/Rate'
      responses:
        200:
          description: 评价成功，返回成功的评价实体
          schema:
            $ref: '#/definitions/Rate'
        401:
          description: 当前未登录或者当前登陆账号和Resume不匹配
        403:
          description: 已经评价过该次实习，或者本次实习状态不是ENDED
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments

  /news:
    post:
      tags:
      - admin
      summary: 新增资讯
      parameters:
      - in: body
        name: news
        description: 资讯实体
        required: true
        schema:
          $ref: '#/definitions/News'
      responses:
        200:
          description: 添加成功
          schema:
            $ref: '#/definitions/News'
        401:
          description: 未登录管理员
        400:
          description: Bad request, invalid arguments
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
      - news
      - admin
      summary: 获取资讯列表
      parameters:
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回资讯列表信息
          schema:
            $ref: '#/definitions/List-News'
        500:
          description: 错误
          schema:
            $ref: '#/definitions/Error'

  /news/{newsId}:
    get:
      tags:
      - news
      - admin
      summary: 获取资讯信息（同时浏览量+1）
      parameters:
      - in: path
        name: newsId
        description: 资讯Id。
        required: true
        type: integer
      responses:
        200:
          description: 成功，返回对应资讯信息
          schema:
            $ref: '#/definitions/News'
        404:
          description: 获取失败，此资讯不存在
          schema:
            $ref: '#/definitions/Error'
    put:
      tags:
      - admin
      summary: 修改资讯
      parameters:
      - in: path
        name: newsId
        description: 资讯Id。
        required: true
        type: integer
      - in: body
        name: news
        description: 修改内容
        required: true
        schema:
            $ref: '#/definitions/News' 
      responses:
        200:
          description: 修改成功，返回对应资讯
          schema:
            $ref: '#/definitions/News'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录管理员
        404:
          description: 修改失败，资讯不存在
          schema:
            $ref: '#/definitions/Error'

  /news/{newsId}/star:
    post:
      tags:
      - news
      summary: 点赞
      parameters:
      - in: path
        name: newsId
        description: 资讯Id。
        required: true
        type: integer
      responses:
        200:
          description: 点赞成功，返回对应资讯信息
          schema:
            $ref: '#/definitions/News'
        401:
          description: 当前未登录
        403:
          description: 当前已经点赞，不能重复点赞
        404:
          description: 获取失败，此资讯不存在
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
      - news
      summary: 取消点赞
      parameters:
      - in: path
        name: newsId
        description: 资讯Id。
        required: true
        type: integer
      responses:
        200:
          description: 取消点赞成功，返回对应资讯信息
          schema:
            $ref: '#/definitions/News'
        401:
          description: 当前未登录
        403:
          description: 当前未点赞
        404:
          description: 获取失败，此资讯不存在
          schema:
            $ref: '#/definitions/Error'
  /admins:
    post:
      tags:
      - admin
      summary: 管理员注册
      description: 只能使用一次，注册成功后无法再注册管理员。
      parameters:
      - in: body
        name: student
        description: 注册的账号信息
        required: true
        schema:
          $ref: '#/definitions/BasicAccount'
      responses:
        200:
          description: 注册成功
          schema:
            $ref: '#/definitions/Account'
        403:
          description: 注册失败，已注册过管理员
          schema:
            $ref: '#/definitions/Error'
        400:
          description: Bad request, invalid arguments

  /admins/login:
    post:
      tags:
      - admin
      summary: 管理员登录
      parameters:
      - in: body
        name: account
        description: 登录信息
        required: true
        schema:
          $ref: '#/definitions/BasicAccount'
      responses:
        200:
          description: 登录成功，返回账号信息
          schema:
            $ref: '#/definitions/Account'
        400:
          description: Bad request, invalid arguments
        403:
          description: 登录失败，账号不存在或密码错误
          schema:
            $ref: '#/definitions/Error'

  /accounts/{accountId}:
    put:
      tags:
      - account
      summary: 修改账户信息
      parameters:
      - in: path
        name: accountId
        description: 账号id，若为0表示当前登陆账号。
        required: true
        type: integer
      - in: body
        name: account
        description: 账号修改实体
        schema:
          $ref: '#/definitions/BasicAccount'
      responses:
        200:
          description: 修改成功，返回账号信息
          schema:
            $ref: '#/definitions/Account'
        400:
          description: Bad request, invalid arguments
        403:
          description: 修改失败，权限不足。 或者账号重复（修改手机号的情况）
        404:
          description: 账号不存在
          schema:
            $ref: '#/definitions/Error' 

  /accounts/{accountId}/pointLogs:
    get:
      tags:
      - account
      - pointlog
      summary: 获取积分记录
      parameters:
      - in: path
        name: accountId
        description: 账号id，若为0表示当前登陆账号。
        required: true
        type: integer
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回积分记录列表。
          schema:
            $ref: '#/definitions/List-PointLog'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error' 

  /accounts/{accountId}/wechat:
    put:
      tags:
      - account
      summary: 绑定微信openid
      parameters:
      - in: path
        name: accountId
        description: 账号id，若为0表示当前登陆账号。
        required: true
        type: integer
      - in: query
        name: openid
        description: wechat openid
        required: true
        type: string
      responses:
        200:
          description: 成功，返回账号信息
          schema:
            $ref: '#/definitions/Account'
        404:
          description: 账号不存在
          schema:
            $ref: '#/definitions/Error' 

  /accounts/logout:
    post:
      tags:
      - other
      summary: 登出
      responses:
        200:
          description: 成功，返回登出前账号信息
          schema:
            $ref: '#/definitions/Account'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error' 

  /pointLogs:
    get:
      tags:
      - pointlog
      summary: 获取积分记录
      parameters:
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回积分记录列表。
          schema:
            $ref: '#/definitions/List-PointLog'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error' 
  /pointLogs/{plogId}:
    get:
      tags:
      - pointlog
      summary: 获取指定积分记录
      parameters:
      - in: path
        name: plogId
        type: integer
        description: 积分记录的id
        example: 1
      responses:
        200:
          description: 成功，返回积分记录。
          schema:
            $ref: '#/definitions/PointLog'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error' 
  /notifications:
    get:
      tags:
      - notification
      summary: 获取通知
      parameters:
      - $ref: '#/parameters/PageSize'
      - $ref: '#/parameters/PageIndex'
      responses:
        200:
          description: 成功，返回通知列表。
          schema:
            $ref: '#/definitions/List-PointLog'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error' 
  /notifications/{notiId}:
    get:
      tags:
      - notification
      summary: 获取指定通知，并标记为已读。
      parameters:
      - in: path
        name: notiId
        type: integer
        description: 通知的id
        example: 1
      responses:
        200:
          description: 成功，返回通知。
          schema:
            $ref: '#/definitions/PointLog'
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error' 

  /codes:
    post:
      tags:
      - other
      summary: 发送验证码
      parameters:
      - in: query
        name: phone
        type: string
        description: 手机号
        required: true
      responses:
        200:
          description: 成功
          schema:
            $ref: '#/definitions/Code'
        400:
          description: Bad request, invalid arguments
          schema:
            $ref: '#/definitions/Error'

    get:
      tags:
      - other
      summary: 验证验证码
      parameters:
      - in: query
        name: phone
        type: string
        description: 手机号
        required: true
      - in: query
        name: code
        type: string
        description: 验证码
        required: true
      responses:
        200:
          description: 成功
          schema:
            $ref: '#/definitions/Code'
        404:
          description: 验证失败
          schema:
            $ref: '#/definitions/Error'


  /upload/{type}:
    post:
      tags:
      - other
      summary: 上传照片
      consumes:
         - multipart/form-data
      parameters:
      - in: path
        name: type
        type: string
        enum:
          - STU_AVATAR
          - STU_CARD
          - STU_CERT
          - COMPANY_LOGO
          - COMPANY_CERT
          - OTHER
        required: true
        description: 照片分类  
      - in: formData
        name: file
        type: file
        description: 要上传的照片文件
      responses:
        200:
          description: 成功，返回上传结果
          schema:
            $ref: '#/definitions/UploadResult'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录
          schema:
            $ref: '#/definitions/Error'
  
  /meta:
    post:
      tags:
      - other
      summary: 添加或修改meta
      parameters:
      - in: body
        name: meta
        schema:
          $ref: '#/definitions/Meta'
        required: true
        description: meta实体  
      responses:
        200:
          description: 成功，返回结果
          schema:
            $ref: '#/definitions/Meta'
        400:
          description: Bad request, invalid arguments
        401:
          description: 当前未登录管理员账号
          schema:
            $ref: '#/definitions/Error'
    get:
      tags:
      - other
      summary: 获取meta
      parameters:
      - in: query
        name: key
        type: string
        required: true
        description: key
      responses:
        200:
          description: 成功，返回结果
          schema:
            $ref: '#/definitions/Meta'


parameters:
  
  PageSize:
    in: query
    name: pageSize
    type: integer
    description: 分页大小（每页的item数目）
  
  PageIndex:
    in: query
    name: pageIndex
    type: integer
    description: 页码（从1开始）


definitions:

  BasicAccount:
    type: object
    required: 
      - phone
      - password
    properties:
      phone:
        type: string
        description: 登录手机号
        example: '18810203423'
      password:
        type: string
        description: 登录密码
        example: 'password'
      unreadNotis:
        type: integer
        description: 未读消息数量
        example: 10
        readOnly: true

  Account:
    type: object
    allOf: 
      - $ref: '#/definitions/BasicAccount'
      - $ref: '#/definitions/BasicModel'
      - properties:
          role:
            type: string
            description: 账号类型
            enum: 
              - 'ADMIN'
              - 'COMPANY'
              - 'STUDENT'
            example: 'COMPANY'
          wechat:
            type: string
            description: wechat oauth id
            example: 'gdalkdsowkdcasdfa'

  CompanyUpdater:
    type: object
    properties:
      name:
        type: string
        example: 'Google Inc.'
        description: 公司名
      addr:
        type: string
        example: 'No123 Bake Street'
        description: 公司地址
      type:
        type: string
        example: '民营'
        description: 公司性质
      scale:
        type: string
        example: 'scale'
        description: 公司规模
      contact:
        type: string
        description: 公司联系人
      contactPos:
        type: string
        description: 联系人职位
      contactPhone:
        type: string
        description: 联系人电话
      avatar:
        type: string
        description: 联系人头像
      email:
        type: string
        description: HR邮箱
      phone:
        type: string
        description: 公司电话
      industry:
        type: string
        description: 公司所属行业
      code:
        type: string
        description: 统一社会信用代码
      intro:
        type: string
        description: 公司简介
      video:
        type: string
        description: 公司介绍视频
      link:
        type: string
        description: 公司网页
        example: 'http://www.baidu.com'
      logo:
        type: string
        description: 公司logo url
      cert:
        type: string
        description: 公司营业执照 url

  Rate:
    allOf: 
      - $ref: '#/definitions/BasicModel'
      - properties:
          resumeId:
            type: integer
            readOnly: true
          companyId:
            type: integer
            readOnly: true
          stuId:
            type: integer
            readOnly: true
          score1:
            type: integer
            description: 评分1
            example: 3
          score2:
            type: integer
            description: 评分2
            example: 3
          score3:
            type: integer
            description: 评分3
            example: 3
          score4:
            type: integer
            description: 评分4
            example: 3
          score5:
            type: integer
            description: 评分5
            example: 3
          comment:
            type: string
            description: 文字评价
  
  AvgRate:
    type: object
    properties:
      score1:
        type: float
        description: 评分1
        example: 2.5
        readOnly: true
      score2:
        type: float
        description: 评分2
        example: 2.5
        readOnly: true
      score3:
        type: float
        description: 评分3
        example: 2.5
        readOnly: true
      score4:
        type: float
        description: 评分4
        example: 2.5
        readOnly: true
      score5:
        type: float
        description: 评分5
        example: 2.5
        readOnly: true
    
  Company:
    allOf: 
      - $ref: '#/definitions/BasicModel'
      - $ref: '#/definitions/AccModel'
      - $ref: '#/definitions/CompanyUpdater'
      - properties:
          avgRate:
            $ref: '#/definitions/AvgRate'
          verified:
            type: boolean
            description: 是否已认证
            readOnly: true
          activePosCnt:
            type: integer
            description: 在招职位数量
          rateCnt:
            type: integer
            description: 评价数量
          createTime:
            $ref: '#definitions/Timestamp'
     
  StudentUpdater:
    type: object
    properties:
      name:
        type: string
        example: 'Ye'
        description: 姓名
      idNo:
        type: string
        example: '32088219920901012X'
        description: 身份证号
      phone:
        type: string
        description: 电话
      gender:
        $ref: '#definitions/Gender'
      education:
        $ref: '#definitions/Education'
      major:
        type: string
        description: 专业
      area:
        type: string
        description: 区域
      email:
        type: string
        description: 邮箱
      school:
        type: string
        description: 学校
      language:
        type: string
        description: 语言
      langLevel:
        $ref: '#definitions/LangLevel'
      grade:
        type: integer
        description: 年级
      stuCard:
        type: string
        description: 学生卡照片url
      certs:
        type: array
        description: 证书照片url数组
      selfEval:
        type: string
        description: 自我评价
      socialExp:
        type: string
        description: 社会经验
      workExp:
        type: string
        description: 工作经验
      avatar:
        type: string
        description: 头像url
      subscription:
        type: object
        description: 订阅
        properties:
          industry:
            type: string
            example: 互联网行业
          type:
            type: string
            example: 国营企业
          area:
            type: string
            example: 闵行区

  Student:
    type: object
    required: 
      - account
      - name
      - phone
    allOf: 
      - $ref: '#/definitions/BasicModel'
      - $ref: '#/definitions/AccModel'
      - $ref: '#/definitions/StudentUpdater'
      - properties:
          createTime:
            $ref: '#definitions/Timestamp'

  PositionUpdater:
    type: object
    properties:
      title:
        type: string
        description: 职位标题
      area:
        type: string
        description: 工作地区
      addr:
        type: string
        description: 工作地址
      startDate:
        type: string
        example: '2017-09-01'
        description: 开始日期
      endDate:
        type: string
        example: '2017-10-01'
        description: 结束日期
      startTime:
        type: string
        example: '08:00:00'
        description: 工作开始时间
      endTime:
        type: string
        example: '18:00:00'
        description: 工作结束时间
      salary:
        type: integer
        example: 200
        description: 企业发放薪资（元），学生获得的薪资由后端自动计算扣除平台手续费
      unit:
        type: string
        description: 薪资单位（每天/每周/每月等）
      minDays:
        type: integer
        description: 最少工作天数
      continuous:
        type: boolean
        description: 是否要求连续工作
      count:
        type: integer
        description: 剩余招聘人数
      retention:
        type: boolean
        description: 是否可留任
      intro:
        type: string
        description: 职位简介
      reqGender:
        $ref: '#definitions/Gender'
      reqEdu:
        $ref: '#definitions/Education'
      reqGrade:
        type: integer
        description: 年级
      reqMajor:
        type: string
        description: 专业
      reqLang:
        type: string
        description: 语言
      reqLangLevel:
        $ref: '#definitions/LangLevel'
      active:
        type: boolean
        description: 是否在招
      
  Position:
    type: object
    allOf:
      - $ref: '#/definitions/BasicModel'
      - $ref: '#/definitions/PositionUpdater'
      - properties:
          companyId:
            type: integer
            readOnly: true
          company:
            type: object
            readOnly: true
          stuSalary:
            type: integer
            description: 学生获得的薪资（扣除平台手续费）
            readOnly: true
          collected:
            type: boolean
            description: 当前是否已收藏（只对学生账户有效）
            readOnly: true
          internCnt:
            type: integer
            description: 正在实习的人数
          candidateCnt:
            type: integer
            description: 投递人数
          createTime:
            $ref: '#definitions/Timestamp'

  ResumeUpdater:
    type: object
    properties:
      state:
        type: string
        enum:
          - NEW
          - WAIT_STU_CONFIRM
          - CONFIRMED
          - OFFERED
          - WORKING
          - ENDED
          - CANCELED
      interviewTime:
        type: string
        example: '2017-10-01 08:00:00'
        description: '面试时间'
      commentStu:
        type: string
        description: 学生对企业的评价
      commentComp:
        type: string
        description: 企业对学生的评价

  Resume:
    type: object
    allOf:
      - $ref: '#/definitions/BasicModel'
      - $ref: '#/definitions/ResumeUpdater'
      - properties:
          positionId:
            type: integer
          stuId:
            type: integer
            readOnly: true
          createTime:
            $ref: '#/definitions/Timestamp'
          updateTime:
            $ref: '#/definitions/Timestamp'

  News:
    type: object
    allOf:
      - $ref: '#/definitions/BasicModel'
      - properties:
          title:
            type: string
            description: 标题
          content:
            type: string
            description: 内容，富文本（html)
          view:
            type: integer
            description: 浏览量
          star:
            type: integer
            description: 点赞量
          starred:
            type: boolean
            description: 当前是否已点赞（登陆后有效）
            readOnly: true
          createTime:
            type: string
            example: '2017-10-01 10:00:00'

  PointLog:
    type: object
    allOf:
      - $ref: '#/definitions/BasicModel'
      - properties:
          accountId:
            type: integer
            example: 456
          type:
            type: string
            enum:
              - REGISTER
              - PROFILE
              - LOGIN
              - POSITION
              - RESUME
              - EMPLOY
              - COMMENT
              - STAR5
              - RECOMMEND
          value:
            type: integer
            description: 积分值
          refid:
            type: integer
            description: 相关id，登陆为当日时间戳，注册为学生/公司id，等等。
          createTime:
            type: string
            example: '2017-10-01 10:00:00'
            readOnly: true
  
  Notification:
    type: object
    allOf:
      - $ref: '#/definitions/BasicModel'
      - properties:
          accountId:
            type: integer
            example: 456
          type:
            type: string
            description: 通知类型，用于确定refid指定的实体类型
            enum:
              - POINT
              - RESUME
              - SALARY
              - WITHDRAW
              - COMMENT
              - BACKEND
          msg:
            type: string
            description: 消息内容
          refid:
            type: integer
            description: 相关实体id。
          createTime:
            type: string
            example: '2017-10-01 10:00:00'
            readOnly: true

  List-Student:
    type: object
    properties:
      pagination:
        $ref: '#/definitions/Pagination'
      items:
        type: array
        items:
          $ref: '#/definitions/Student'

  List-Company:
    type: object
    properties:
      pagination:
        $ref: '#/definitions/Pagination'
      items:
        type: array
        items:
          $ref: '#/definitions/Company'
          
  List-Position:
    type: object
    properties:
      pagination:
        $ref: '#/definitions/Pagination'
      items:
        type: array
        items:
          $ref: '#/definitions/Position'
          
  List-Resume:
    type: object
    properties:
      pagination:
        $ref: '#/definitions/Pagination'
      items:
        type: array
        items:
          $ref: '#/definitions/Resume'
          
  List-News:
    type: object
    properties:
      pagination:
        $ref: '#/definitions/Pagination'
      items:
        type: array
        items:
          $ref: '#/definitions/News'

  List-PointLog:
    type: object
    properties:
      pagination:
        $ref: '#/definitions/Pagination'
      items:
        type: array
        items:
          $ref: '#/definitions/PointLog'

  List-Notification:
    type: object
    properties:
      pagination:
        $ref: '#/definitions/Pagination'
      items:
        type: array
        items:
          $ref: '#/definitions/Notification'

  List-Rate:
    type: object
    properties:
      pagination:
        $ref: '#/definitions/Pagination'
      items:
        type: array
        items:
          $ref: '#/definitions/Rate'

  UploadResult:
    type: object
    properties:
      success:
        type: boolean
        description: 是否成功
      msg:
        type: string
        description: 失败时的提示信息
      url:
        type: string
        description: 上传成功时，返回对应的url
  
  Code:
    type: object
    allOf:
      - $ref: '#/definitions/BasicModel'
      - properties:
          phone:
            type: string
          code:
            type: string
            readOnly: true
          createTime:
            type: string
            example: '2017-10-01 10:00:00'
            readOnly: true

  Meta:
    type: object
    properties:
      key:
        type: string
      value:
        type: string

# Errors
  Error:
    type: object
    required:
      - status
      - developerMessage
      - userMessage
    properties:
      status:
        type: string
        example: "500"
      developerMessage:
        type: string
        description: Message for developers to locate the problem.
        example: "Unkown Error."
      userMessage:
        type: string
        description: Message for the end-user.
        example: "Sorry, We have encounted an unkown error."


# others:

  BasicModel:
    type: object
    properties:
      id:
        type: integer
        example: 123
        readOnly: true

  AccModel:
    type: object
    properties:
      accountId:
        type: integer
        example: 456
        readOnly: true
      account:
        $ref: '#/definitions/BasicAccount'

  Pagination:
    type: object
    properties:
      pageSize:
        type: integer
        description: 单页显示item数量
      pageCnt:
        type: integer
        description: 总页数
      pageIndex:
        type: integer
        description: 当前页码（从1开始）
      rowCnt:
        type: integer
        description: item总数目

  Gender:
    type: string
    description: 性别
    enum: 
      - MALE
      - FEMALE

  Education:
    type: string
    description: 学历
    enum:
      - COLLEGE
      - BACHELOR
      - MASTER
      - PHD

  LangLevel:
    type: string
    description: 语言水平
    enum:
      - NORMAL
      - GOOD
      - SKILLED
      - PROFICIENT

  Timestamp:
    type: string
    example: '2017-10-01 08:00:00'
    readOnly: true
